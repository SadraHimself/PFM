<p align="center">
  <pre>
   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ–ˆâ•—
   â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ•‘
   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•”â–ˆâ–ˆâ–ˆâ–ˆâ•”â–ˆâ–ˆâ•‘
   â–ˆâ–ˆâ•”â•â•â•â• â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘
   â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘ â•šâ•â• â–ˆâ–ˆâ•‘
   â•šâ•â•     â•šâ•â•     â•šâ•â•     â•šâ•â•
  </pre>
  <h3>Port Forward Manager</h3>
  <p>Port Forwarding Tool with Per-Port Bandwidth Monitoring</p>

  <a href="https://t.me/AbrAfagh"><img src="https://img.shields.io/badge/Telegram-Channel-blue?logo=telegram" alt="Telegram"></a>
  <img src="https://img.shields.io/badge/Version-1.7-green" alt="Version">
  <img src="https://img.shields.io/badge/License-MIT-yellow" alt="License">
  <img src="https://img.shields.io/badge/OS-Ubuntu%2FDebian-orange" alt="OS">
</p>

---

<div dir="rtl" align="right">

## ğŸ‡®ğŸ‡· ÙØ§Ø±Ø³ÛŒ

### Ù¾ÛŒâ€ŒØ§Ùâ€ŒØ§Ù… Ú†ÛŒØ³ØªØŸ

PFM ÛŒÚ© Ø§Ø¨Ø²Ø§Ø± Ù…Ø¯ÛŒØ±ÛŒØª Ù¾ÙˆØ±Øª ÙÙˆØ±ÙˆØ§Ø±Ø¯ Ø¨Ø§ Ù‚Ø§Ø¨Ù„ÛŒØª Ù…Ø§Ù†ÛŒØªÙˆØ±ÛŒÙ†Ú¯ ØªØ±Ø§ÙÛŒÚ© Ø±ÙˆÛŒ Ù‡Ø± Ù¾ÙˆØ±Øª Ø§Ø³Øª. Ø§ÛŒÙ† Ø§Ø¨Ø²Ø§Ø± Ø¨Ù‡ Ø´Ù…Ø§ Ø§Ø¬Ø§Ø²Ù‡ Ù…ÛŒØ¯Ù‡Ø¯ Ù¾ÙˆØ±Øªâ€ŒÙ‡Ø§ÛŒ Ø³Ø±ÙˆØ± Ø§ÛŒØ±Ø§Ù† Ø±Ø§ Ø¨Ù‡ Ø³Ø±ÙˆØ± Ø®Ø§Ø±Ø¬ ÙÙˆØ±ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯ Ùˆ Ù…ØµØ±Ù ØªØ±Ø§ÙÛŒÚ© Ù‡Ø± Ú©Ø§Ø±Ø¨Ø± Ø±Ø§ Ø¨Ù‡ ØµÙˆØ±Øª Ø¯Ù‚ÛŒÙ‚ Ù¾ÛŒÚ¯ÛŒØ±ÛŒ Ùˆ Ù…Ø­Ø¯ÙˆØ¯ Ú©Ù†ÛŒØ¯.

### âœ¨ Ø§Ù…Ú©Ø§Ù†Ø§Øª

- **Ø³Ù‡ Ù…ÙˆØªÙˆØ±** â€” iptablesØŒ HAProxy Ùˆ Realm (Ø¨Ù‡ØªØ±ÛŒÙ† Ø¹Ù…Ù„Ú©Ø±Ø¯)
- **Ù…Ø§Ù†ÛŒØªÙˆØ±ÛŒÙ†Ú¯ ØªØ±Ø§ÙÛŒÚ©** â€” Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ù…ØµØ±Ù Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø±ÙˆÛŒ Ù‡Ø± Ù¾ÙˆØ±Øª Ø¨Ù‡ ØµÙˆØ±Øª Ù„Ø­Ø¸Ù‡â€ŒØ§ÛŒ
- **Ù…Ø­Ø¯ÙˆØ¯ÛŒØª ØªØ±Ø§ÙÛŒÚ©** â€” ØªØ¹ÛŒÛŒÙ† Ø³Ù‚Ù Ù…ØµØ±Ù Ø¨Ø± Ø­Ø³Ø¨ Ú¯ÛŒÚ¯Ø§Ø¨Ø§ÛŒØª Ùˆ Ù‚Ø·Ø¹ Ø®ÙˆØ¯Ú©Ø§Ø±
- **Ù…Ø¯ÛŒØ±ÛŒØª Ú©Ø§Ø±Ø¨Ø±Ø§Ù†** â€” Ø§Ø®ØªØµØ§Øµ Ù¾ÙˆØ±Øª Ø¨Ù‡ Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ø¨Ø§ Ù„ÛŒÙ†Ú© Ø¢ÛŒØ¯ÛŒ ØªÙ„Ú¯Ø±Ø§Ù…
- **Ø±Ø¨Ø§Øª ØªÙ„Ú¯Ø±Ø§Ù…** â€” Ù…Ø¯ÛŒØ±ÛŒØª Ú©Ø§Ù…Ù„ Ø§Ø² Ø±Ø§Ù‡ Ø¯ÙˆØ± Ø¨Ø§ Ø±Ø¨Ø§Øª ØªÙ„Ú¯Ø±Ø§Ù…
- **Ø¨Ú©Ø§Ù¾ Ø®ÙˆØ¯Ú©Ø§Ø±** â€” Ú¯Ø²Ø§Ø±Ø´ Ø¨Ú©Ø§Ù¾ ØªØ±Ø§ÙÛŒÚ© Ù‡Ø± Û¶ Ø³Ø§Ø¹Øª
- **Ù‡Ù„Ø«â€ŒÚ†Ú© Realm** â€” Ø±ÛŒØ³ØªØ§Ø±Øª Ø®ÙˆØ¯Ú©Ø§Ø± Ø³Ø±ÙˆÛŒØ³â€ŒÙ‡Ø§ÛŒ Ø®Ø±Ø§Ø¨
- **Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ IPv4 Ùˆ IPv6**

### ğŸš€ Ù†ØµØ¨ Ø³Ø±ÛŒØ¹

<div dir="ltr" align="left">

```bash
bash <(curl -s https://raw.githubusercontent.com/SadraHimself/PFM/main/pfm.sh) install
```

</div>

### ğŸ¤– Ù†ØµØ¨ Ø±Ø¨Ø§Øª ØªÙ„Ú¯Ø±Ø§Ù…

<div dir="ltr" align="left">

```bash
bash <(curl -s https://raw.githubusercontent.com/SadraHimself/PFM/main/pfm-bot-setup.sh)
```

</div>

### ğŸ“¬ Ø§Ø±ØªØ¨Ø§Ø· Ø¨Ø§ Ù…Ø§

- Ú©Ø§Ù†Ø§Ù„ ØªÙ„Ú¯Ø±Ø§Ù…: [@AbrAfagh](https://t.me/AbrAfagh)

</div>

---

## ğŸ‡¬ğŸ‡§ English

### âœ¨ Features

- **Multi-Engine** â€” iptables, HAProxy (splice), Realm (zero-copy)
- **Per-Port Bandwidth Monitoring** â€” Track download usage per port in real-time
- **Traffic Limits** â€” Set GB limits per port, auto-block when exceeded
- **User Management** â€” Assign ports to users with Telegram ID linking
- **Telegram Bot** â€” Full remote management via Telegram bot
- **Auto Backup** â€” 6-hour automatic traffic backup reports
- **Realm Health Check** â€” Auto-restart crashed or stuck Realm services
- **MTU Management** â€” Persistent MTU settings per interface
- **IPv4 & IPv6** â€” Full dual-stack support
- **Menu-Driven** â€” Easy interactive CLI interface

## ğŸš€ Quick Install

```bash
bash <(curl -s https://raw.githubusercontent.com/SadraHimself/PFM/main/pfm.sh) install
```

## ğŸ“¦ Manual Install

```bash
curl -o /usr/local/bin/pfm https://raw.githubusercontent.com/SadraHimself/PFM/main/pfm.sh
chmod +x /usr/local/bin/pfm
pfm install
```

## ğŸ¤– Telegram Bot Setup

The bot allows you to manage all your PFM servers remotely from Telegram.

```bash
bash <(curl -s https://raw.githubusercontent.com/SadraHimself/PFM/main/pfm-bot-setup.sh)
```

**Bot Features:**
- ğŸ“Š View traffic usage per user/port across all servers
- ğŸ”„ Sync traffic data
- ğŸ”´ğŸŸ¢ Block/Unblock ports
- ğŸ“ Set/Edit traffic limits
- â•â– Add/Subtract traffic
- ğŸ“¦ Manual & automatic backups (every 6h)
- âš™ï¸ Edit server connections from Telegram
- ğŸ‘¤ Users can check their own usage via bot

## ğŸ“¸ Screenshots

<details>
<summary>CLI Menu</summary>

```
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
         PFM - Port Forward Manager v1.7
              https://t.me/AbrAfagh
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

  1)  Add Tunnel
  2)  Manage Tunnels
  3)  View Traffic
  4)  Monitor (Live)
  5)  Users
  6)  MTU Settings
  7)  Install / Update
  8)  Uninstall
  0)  Exit
```

</details>

<details>
<summary>Traffic View</summary>

```
  Traffic  (Download Only)

  a_real_shit [ON]  TG:1605183796

  PORT    DESTINATION        ENGINE    USED          LIMIT         REMAIN     STATUS
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  6003    91.107.251.41:6003 realm     2.72 MB       1.16 TB       1.16 TB    Active
  6004    91.107.251.41:6004 realm     381.09 KB     846.00 GB     846.00 GB  Active
  TOTAL                                3.10 MB       2.00 TB       2.00 TB
```

</details>

## âš™ï¸ Engines

| Engine | Type | Use Case |
|--------|------|----------|
| **iptables** | Kernel NAT | Default, simple port forwarding |
| **HAProxy** | Splice (TCP) | High-performance TCP proxy |
| **Realm** | Zero-copy | Best performance, TCP + UDP |

## ğŸ“ File Structure

```
/usr/local/bin/pfm          # Main script
/usr/local/bin/pfm-cmd      # Bot command helper
/etc/pfm/
â”œâ”€â”€ users/                  # User configs
â”œâ”€â”€ ports/                  # Port configs
â”œâ”€â”€ usage/                  # Traffic data (bytes)
â”œâ”€â”€ mtu/                    # MTU settings
â””â”€â”€ realm/                  # Realm TOML configs
```

## ğŸ”§ Commands

```bash
pfm                  # Open interactive menu
pfm install          # Install/Update PFM
pfm restore          # Restore rules after reboot
pfm sync             # Sync traffic counters
pfm json             # JSON output (for bot)
pfm monitor          # Live traffic monitor
pfm uninstall        # Remove PFM
```

## ğŸ“‹ Requirements

- Ubuntu 18+ / Debian 10+
- Root access
- `curl` or `wget`
- `sshpass` (for bot password auth)

## ğŸ¤ Contributing

Pull requests are welcome! For major changes, please open an issue first.

## ğŸ“„ License

[MIT](LICENSE)

## ğŸ“¬ Contact

- Telegram Channel: [@AbrAfagh](https://t.me/AbrAfagh)
